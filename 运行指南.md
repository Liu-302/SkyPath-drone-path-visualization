# SkyPath 项目运行指南

本文档提供完整的项目运行步骤，包括数据库、后端和前端。

## 前置要求

在开始之前，请确保已安装以下软件：

- **Java 17+** - [下载地址](https://www.oracle.com/java/technologies/downloads/)
- **Maven 3.6+** - [下载地址](https://maven.apache.org/download.cgi)
- **Node.js 18+** - [下载地址](https://nodejs.org/)
- **Yarn** - 安装命令：`npm install -g yarn`
- **Docker Desktop** - [下载地址](https://www.docker.com/products/docker-desktop/)

## 验证安装

在开始之前，请验证所有工具已正确安装：

```bash
# 检查 Java
java -version

# 检查 Maven
mvn --version

# 检查 Node.js
node --version

# 检查 Yarn
yarn --version

# 检查 Docker
docker --version
```

---

## 完整运行步骤

### 第一步：启动 Docker Desktop

**重要**：必须先启动 Docker Desktop！

1. 打开 Docker Desktop 应用
2. 等待 Docker 完全启动（状态栏显示 "Docker Desktop is running"）
3. 如果还没安装，请访问：https://www.docker.com/products/docker-desktop/

---

### 第二步：启动 MongoDB（使用 Docker）

在项目根目录（`d:\GRP_program\grp-skypath`）打开终端，运行：

```bash
# Windows
start-mongodb.bat

# macOS/Linux
chmod +x start-mongodb.sh
./start-mongodb.sh

# 或直接使用 Docker Compose
docker-compose up -d
```

**验证 MongoDB 是否运行**：
```bash
docker-compose ps
```

应该看到 `skypath-mongodb` 状态为 `Up`

**MongoDB 将在 `localhost:27017` 运行**

---

### 第三步：启动后端

打开一个新的终端窗口，在项目根目录运行：

```bash
cd backend
mvn spring-boot:run
```

**后端将在 `http://localhost:8080` 启动**

**验证后端是否正常**：
- 查看控制台，应该看到 `Started SkyPathBackendApplication`
- 没有 MongoDB 连接错误
- 可以在浏览器访问 `http://localhost:8080` 测试（应该看到 Spring Boot 默认页面或 API 响应）

---

### 第四步：启动前端

再打开一个新的终端窗口，在项目根目录运行：

```bash
cd frontend

# 首次运行需要安装依赖（只需运行一次）
yarn install

# 启动开发服务器
yarn dev
```

**前端将在 `http://localhost:8000` 启动**（或控制台显示的端口）

**验证前端是否正常**：
- 浏览器自动打开或手动访问 `http://localhost:8000`
- 应该看到 SkyPath 应用界面

---

## 完成！

现在所有服务都已启动：

- **MongoDB**: `localhost:27017`
- **后端**: `http://localhost:8080`
- **前端**: `http://localhost:8000`

在浏览器打开 `http://localhost:8000` 开始使用！

---

## 快速命令参考

### 启动所有服务（按顺序）

```bash
# 终端 1：启动 MongoDB
start-mongodb.bat

# 终端 2：启动后端
cd backend
mvn spring-boot:run

# 终端 3：启动前端
cd frontend
yarn dev
```

### MongoDB 管理命令

```bash
# 启动 MongoDB
docker-compose up -d mongodb

# 停止 MongoDB
docker-compose stop mongodb

# 查看 MongoDB 日志
docker-compose logs -f mongodb

# 重置 MongoDB 数据（删除所有数据）
docker-compose down -v

# 进入 MongoDB Shell
docker exec -it skypath-mongodb mongosh skypath
```

### 后端管理命令

```bash
# 启动后端（开发环境，默认）
cd backend
mvn spring-boot:run

# 启动后端（生产环境，使用 MongoDB Atlas）
cd backend
set SPRING_PROFILES_ACTIVE=prod
set MONGODB_URI=mongodb+srv://user:pass@cluster.mongodb.net/skypath
mvn spring-boot:run

# 清理并重新编译
cd backend
mvn clean spring-boot:run
```

### 前端管理命令

```bash
# 安装依赖（首次运行）
cd frontend
yarn install

# 启动开发服务器
cd frontend
yarn dev

```
