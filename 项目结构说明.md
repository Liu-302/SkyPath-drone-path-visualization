# 项目结构说明

## 概述

本项目采用 **全栈分离架构**，分为前端和后端两个独立项目。

## 整体目录结构

```
grp-skypath/
├── frontend/              # Vue.js 前端应用
│   ├── src/              # 前端源码
│   ├── public/           # 静态资源
│   ├── package.json      # 前端依赖配置
│   └── README.md        # 前端文档
│
├── backend/              # Spring Boot 后端应用
│   ├── src/              # 后端源码
│   │   ├── main/
│   │   │   ├── java/com/skypath/backend/
│   │   │   │   ├── SkyPathBackendApplication.java
│   │   │   │   ├── config/          # 配置类
│   │   │   │   ├── controller/      # REST 控制器
│   │   │   │   ├── service/         # 业务逻辑
│   │   │   │   ├── repository/      # 数据访问
│   │   │   │   ├── entity/          # 实体类
│   │   │   │   └── dto/             # 数据传输对象
│   │   │   └── resources/
│   │   │       └── application.properties
│   │   └── test/
│   ├── pom.xml          # Maven 配置
│   ├── README.md        # 后端文档
│   └── API_EXAMPLES.md  # API 使用示例
│
├── LICENSE
├── README.md             # 项目总览文档
└── 项目结构说明.md       # 本文档
```

## 前端结构 (Feature-Based 架构)

前端采用 **特性驱动设计**，按照业务功能模块组织代码。

```
frontend/
├── src/
│   ├── features/                # 业务功能模块
│   │   ├── upload/             # 上传功能
│   │   │   ├── components/     # 组件
│   │   │   ├── composables/    # 组合式函数
│   │   │   ├── types/          # 类型定义
│   │   │   └── composables/    # 逻辑
│   │   │
│   │   ├── kpi/                # KPI 分析
│   │   │   ├── components/
│   │   │   ├── composables/
│   │   │   ├── services/        # 计算服务
│   │   │   └── types/
│   │   │
│   │   ├── visualization/       # 3D 可视化
│   │   │   ├── components/
│   │   │   ├── composables/
│   │   │   ├── services/
│   │   │   └── types/
│   │   │
│   │   └── shared/             # 共享功能
│   │       ├── components/
│   │       ├── composables/
│   │       └── types/
│   │
│   ├── pages/                  # 页面组件
│   │   ├── index.vue
│   │   ├── Upload.vue
│   │   └── Visualize.vue
│   │
│   ├── stores/                 # Pinia 状态管理
│   │   ├── dataset.ts          # 数据集状态
│   │   └── kpi.ts             # KPI 状态
│   │
│   ├── shared/                 # 全局共享资源
│   │   ├── utils/              # 工具函数
│   │   ├── constants/          # 常量
│   │   ├── services/           # 全局服务
│   │   └── types/             # 类型
│   │
│   └── styles/                 # 全局样式
│       └── theme.css
│
└── package.json
```

## 后端结构 (MVC 架构)

后端采用标准的 **Spring Boot MVC 架构**。

```
backend/
├── src/main/java/com/skypath/backend/
│   ├── SkyPathBackendApplication.java  # 主启动类
│   │
│   ├── config/                        # 配置层
│   │   ├── CorsConfig.java            # 跨域配置
│   │   └── MongoDBConfig.java         # MongoDB 配置
│   │
│   ├── controller/                    # 控制层 (REST API)
│   │   ├── UserController.java         # 用户相关 API
│   │   └── ProjectController.java     # 项目相关 API
│   │
│   ├── service/                       # 服务层 (业务逻辑)
│   │   ├── UserService.java           # 用户服务
│   │   ├── ProjectService.java       # 项目服务
│   │   └── KPICalculatorService.java # KPI 计算服务
│   │
│   ├── repository/                    # 持久层 (数据访问)
│   │   ├── UserRepository.java        # 用户数据访问
│   │   ├── ProjectRepository.java    # 项目数据访问
│   │   ├── ObjDataRepository.java    # 模型数据访问
│   │   └── WaypointRepository.java   # 航点数据访问
│   │
│   ├── entity/                        # 实体层 (MongoDB 文档)
│   │   ├── User.java                 # 用户实体
│   │   ├── Project.java              # 项目实体
│   │   ├── ObjData.java              # 模型数据实体
│   │   └── Waypoint.java            # 航点实体
│   │
│   └── dto/                           # 数据传输对象
│       ├── KPIMetrics.java           # KPI 指标
│       └── WaypointData.java         # 航点数据
│
└── pom.xml
```

## 模块说明

### 前端模块

#### 1. features/upload - 上传模块
负责文件上传和模型加载
- `components/` - 上传相关组件
- `composables/` - 上传逻辑

#### 2. features/kpi - KPI 分析模块
负责 KPI 指标计算和显示
- `components/` - KPI 面板组件
- `services/` - KPI 计算服务（前端版本）
- `composables/` - KPI 状态和逻辑

#### 3. features/visualization - 3D 可视化模块
负责 3D 场景渲染和交互
- `components/` - 3D 组件
- `composables/` - 可视化逻辑

### 后端模块

#### 1. controller - 控制层
提供 REST API 接口，处理 HTTP 请求

#### 2. service - 服务层
实现业务逻辑，包括 KPI 计算（后端版本）

#### 3. repository - 持久层
使用 Spring Data MongoDB 访问数据库

#### 4. entity - 实体层
定义 MongoDB 文档结构

## 前后端交互

```
前端 (Vue.js)          后端 (Spring Boot)
    |                        |
    |  HTTP/JSON             |
    |----------------------->|
    |                        |  Controller
    |                        |      |
    |                        |      v
    |                        |   Service
    |                        |      |
    |                        |      v
    |                        | Repository
    |                        |      |
    |                        |      v
    |                        | MongoDB
    |                        |
    |  Response             |
    |<-----------------------|
    |                        |
```

## 技术栈

### 前端
- Vue 3 + Vite
- Three.js + TresJS
- Pinia (状态管理)
- TypeScript

### 后端
- Java 17
- Spring Boot 3.2.0
- Spring Data MongoDB
- MongoDB

## 启动流程

1. **启动 MongoDB**
   ```bash
   mongod
   ```

2. **启动后端**
   ```bash
   cd backend
   mvn spring-boot:run
   ```

3. **启动前端**
   ```bash
   cd frontend
   yarn dev
   ```

## 开发指南

### 修改前端功能
1. 进入 `frontend/src/features/` 找到对应模块
2. 在模块内修改组件、逻辑或服务
3. 前端热更新自动生效

### 修改后端 API
1. 进入 `backend/src/` 修改对应层次代码
2. 修改 Controller 添加新端点
3. 修改 Service 实现业务逻辑
4. 重启后端服务

### 添加新功能
- **前端**: 在 `features/` 创建新模块目录
- **后端**: 在 `controller/` 添加新控制器，在 `service/` 添加新服务
